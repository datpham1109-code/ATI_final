"use strict";exports.id=229,exports.ids=[229],exports.modules={40884:(e,a,r)=>{r.d(a,{f:()=>s,j:()=>i}),r(13664);var t=r(28371),i=(0,t.$)("6b0b0211edf923668136f949a09bd7013731086d"),s=(0,t.$)("8d2176ec601c75517303c18fbd87bf736c5d5e9e")},3365:(e,a,r)=>{r.r(a),r.d(a,{CardWrapper:()=>p});var t=r(95344),i=r(61351),s=r(96874),n=r.n(s),o=r(91626);let l=({label:e})=>(0,t.jsxs)("div",{className:"w-full flex flex-col gap-y-4 items-center justify-center",children:[t.jsx("h1",{className:(0,o.cn)("text-3xl font-semibold",n().className),children:"\uD83D\uDD10 Auth"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:e})]});var d=r(70285),c=r(49921),m=r(16212),u=r(40884),w=r(8428);let f=()=>{let e=(0,w.useSearchParams)().get("callbackUrl");return(0,t.jsxs)("div",{className:"flex items-center w-full gap-x-2",children:[t.jsx(m.z,{size:"lg",className:"w-full",variant:"outline",onClick:()=>(0,u.j)("google",e),children:t.jsx(d.JM8,{className:"h-5 w-5"})}),t.jsx(m.z,{size:"lg",className:"w-full",variant:"outline",onClick:()=>(0,u.j)("github",e),children:t.jsx(c.hJX,{className:"h-5 w-5"})})]})};var g=r(56506);let h=({href:e,label:a})=>t.jsx(m.z,{variant:"link",className:"font-normal w-full",size:"sm",asChild:!0,children:t.jsx(g.default,{href:e,children:a})}),p=({children:e,headerLabel:a,backButtonLabel:r,backButtonHref:s,showSocial:n})=>(0,t.jsxs)(i.Zb,{className:"w-[800px] shadow-md",children:[t.jsx(i.Ol,{children:t.jsx(l,{label:a})}),t.jsx(i.aY,{children:e}),n&&t.jsx(i.eW,{children:t.jsx(f,{})}),t.jsx(i.eW,{children:s&&r&&t.jsx(h,{label:r,href:s})})]})},61351:(e,a,r)=>{r.d(a,{Ol:()=>o,Zb:()=>n,aY:()=>d,eW:()=>c,ll:()=>l});var t=r(95344),i=r(3729),s=r(91626);let n=i.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));n.displayName="Card";let o=i.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...a}));o.displayName="CardHeader";let l=i.forwardRef(({className:e,...a},r)=>t.jsx("h3",{ref:r,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));l.displayName="CardTitle",i.forwardRef(({className:e,...a},r)=>t.jsx("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...a})).displayName="CardDescription";let d=i.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...a}));d.displayName="CardContent";let c=i.forwardRef(({className:e,...a},r)=>t.jsx("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...a}));c.displayName="CardFooter"},36579:(e,a,r)=>{r.r(a),r.d(a,{loginCredentials:()=>p,loginOAuth:()=>b});var t=r(98601);r(75811);var i=r(10985),s=r(19860),n=r(29538),o=r(30634),l=r.n(o),d=r(35175),c=r(48083),m=r(27449),u=r(81746),w=r(89756),f=r(88032),g=r(77264),h=r(17824);let p=async(e,a)=>{let r=i.LoginSchema.safeParse(e);if(!r.success)return{error:"Invalid Fields!"};let{email:t,password:o,code:h}=r.data,p=await (0,d.getUserByEmail)(t);if(!p||!p.email||!p.password)return{error:"Email does not exist!"};if(!await l().compare(o,p.password))return{error:"Invalid password!"};if(!p.emailVerified){let e=await (0,c.generateVerificationToken)(p.email);return await (0,m.sendVerificationEmail)(e.email,e.token),{success:"Confirmation email sent!"}}if(p.isTwoFactorEnabled&&p.email){if(h){let e=await (0,u.getTwoFactorTokenByEmail)(p.email);if(!e||e.token!==h)return{error:"Invalid code!"};if(new Date(e.expires)<new Date)return{error:"Code expired!"};await w.db.twoFactorToken.delete({where:{id:e.id}});let a=await (0,f.getTwoFactorConfirmationByUserId)(p.id);a&&await w.db.twoFactorConfirmation.delete({where:{id:a.id}}),await w.db.twoFactorConfirmation.create({data:{userId:p.id}})}else{let e=await (0,u.generateTwoFactorToken)(p.email);return await (0,m.sendTwoFactorTokenEmail)(e.email,e.token),{twoFactor:!0}}}try{await (0,s.signIn)("credentials",{email:t,password:o,redirectTo:a||g.DEFAULT_LOGIN_REDIRECT})}catch(e){if(e instanceof n.AuthError){if("CredentialsSignin"===e.type)return{error:"Invalid Credials!"};return{error:"Something went wrong!"}}throw e}},b=async(e,a)=>{await (0,s.signIn)(e,{callbackUrl:a||g.DEFAULT_LOGIN_REDIRECT})};(0,h.ensureServerEntryExports)([p,b]),(0,t.createActionProxy)("8d2176ec601c75517303c18fbd87bf736c5d5e9e",p),(0,t.createActionProxy)("6b0b0211edf923668136f949a09bd7013731086d",b)},27449:(e,a,r)=>{r.d(a,{sendPasswordResetEmail:()=>o,sendTwoFactorTokenEmail:()=>s,sendVerificationEmail:()=>n});let t=new(r(2384)).Resend(process.env.RESEND_API_KEY),i="http://localhost:3000",s=async(e,a)=>{await t.emails.send({from:"onboarding@resend.dev",to:e,subject:"2FA Code",html:`<p>Your 2FA code: ${a}</p>`})},n=async(e,a)=>{let r=`${i}/auth/new-verification?token=${a}`;await t.emails.send({from:"onboarding@resend.dev",to:e,subject:"Confirm your email",html:`<p>Click <a href="${r}">here</a> to confirm email.</p>`})},o=async(e,a)=>{let r=`${i}/auth/new-password?token=${a}`;await t.emails.send({from:"onboarding@resend.dev",to:e,subject:"Reset your password",html:`<p>Click <a href="${r}">here</a> to reset password.</p>`})}},31001:(e,a,r)=>{r.d(a,{getAccountByUserId:()=>i});var t=r(89756);let i=async e=>{try{return await t.db.account.findFirst({where:{userId:e}})}catch{return null}}},88032:(e,a,r)=>{r.d(a,{getTwoFactorConfirmationByUserId:()=>i});var t=r(89756);let i=async e=>{try{return await t.db.twoFactorConfirmation.findUnique({where:{userId:e}})}catch{return null}}},81746:(e,a,r)=>{r.d(a,{generateTwoFactorToken:()=>n,getTwoFactorTokenByEmail:()=>o});var t=r(6113),i=r.n(t),s=r(89756);let n=async e=>{let a=i().randomInt(1e5,1e6).toString(),r=new Date(new Date().getTime()+36e5),t=await o(e);return t&&await s.db.twoFactorToken.delete({where:{id:t.id}}),await s.db.twoFactorToken.create({data:{email:e,token:a,expires:r}})},o=async e=>{try{return await s.db.twoFactorToken.findFirst({where:{email:e}})}catch{return null}}},35175:(e,a,r)=>{r.d(a,{getUserByEmail:()=>i,getUserById:()=>s});var t=r(89756);let i=async e=>{try{return await t.db.user.findUnique({where:{email:e}})}catch{return null}},s=async e=>{try{return await t.db.user.findUnique({where:{id:e}})}catch{return null}}},48083:(e,a,r)=>{r.d(a,{generateVerificationToken:()=>s,getVerificationTokenByToken:()=>n});var t=r(3078),i=r(89756);let s=async e=>{let a=(0,t.v4)(),r=new Date(new Date().getTime()+36e5),s=await o(e);return s&&await i.db.verificationToken.delete({where:{id:s.id}}),await i.db.verificationToken.create({data:{email:e,token:a,expires:r}})},n=async e=>{try{return await i.db.verificationToken.findUnique({where:{token:e}})}catch{return null}},o=async e=>{try{return await i.db.verificationToken.findFirst({where:{email:e}})}catch{return null}}},25414:(e,a,r)=>{r.d(a,{default:()=>d});var t=r(35175),i=r(10985),s=r(30634),n=r.n(s),o=r(76714),l=r(24320);let d={providers:[(0,r(67152).default)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,l.default)({clientId:process.env.GITHUB_CLIENT_ID,clientSecret:process.env.GITHUB_CLIENT_SECRET}),(0,o.default)({async authorize(e){let a=i.LoginSchema.safeParse(e);if(a.success){let{email:e,password:r}=a.data,i=await (0,t.getUserByEmail)(e);if(!i||!i.password)return null;if(await n().compare(r,i.password))return i}return null}})]}},19860:(e,a,r)=>{r.d(a,{auth:()=>m,signIn:()=>u,signOut:()=>w});var t=r(29538),i=r(25414),s=r(28388),n=r(89756),o=r(35175),l=r(31001);let{handlers:{GET:d,POST:c},auth:m,signIn:u,signOut:w}=(0,t.default)({session:{strategy:"jwt"},pages:{signIn:"/auth/login",error:"/auth/error"},events:{async linkAccount({user:e}){await n.db.user.update({where:{id:e.id},data:{emailVerified:new Date}})}},callbacks:{async signIn({user:e,account:a}){let r;return a?.provider!=="credentials"||(e.id&&(r=await (0,o.getUserById)(e.id)),!!r?.emailVerified)},session:async({session:e,token:a})=>(a.sub&&e.user&&(e.user.id=a.sub),a.role&&e.user&&(e.user.role=a.role),e.user&&(e.user.isTwoFactorEnabled=a.isTwoFactorEnabled,e.user.name=a.name,e.user.email=a.email,e.user.isOAuth=a.isOAuth),e),async jwt({token:e}){if(!e.sub)return e;let a=await (0,o.getUserById)(e.sub);if(!a)return e;let r=await (0,l.getAccountByUserId)(a.id);return e.isOAuth=!!r,e.name=a.name,e.role=a.role,e.isTwoFactorEnabled=a.isTwoFactorEnabled,e}},adapter:(0,s.PrismaAdapter)(n.db),...i.default})},77264:(e,a,r)=>{r.d(a,{DEFAULT_LOGIN_REDIRECT:()=>t});let t="/settings"},10985:(e,a,r)=>{r.d(a,{LoginSchema:()=>s,NewPasswordSchema:()=>n,RegisterSchema:()=>o,ResetSchema:()=>l});var t=r(53524),i=r(86412);i.object({name:i.optional(i.string()),isTwoFactorEnabled:i.optional(i.boolean()),role:i.enum([t.UserRole.ADMIN,t.UserRole.USER]),email:i.optional(i.string().email()),password:i.optional(i.string().min(1)),newPassword:i.optional(i.string().min(6))}).refine(e=>!e.password||!!e.newPassword,{message:"New password is required!",path:["newPassword"]}).refine(e=>!e.newPassword||!!e.password,{message:"Password is required!",path:["password"]});let s=i.object({email:i.string().email({message:"Email is required"}),password:i.string().min(1,{message:"Password is required"}),code:i.optional(i.string())}),n=i.object({password:i.string().min(1,{message:"Minimum of 6 characters required"})}),o=i.object({email:i.string().email({message:"Email is required"}),password:i.string().min(1,{message:"Password is required"}),name:i.string().min(1,{message:"Name is required"})}),l=i.object({email:i.string().email({message:"Email is required"})})},57481:(e,a,r)=>{r.r(a),r.d(a,{default:()=>i});var t=r(70337);let i=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,t.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]}};